<!DOCTYPE html>
<html
  dir="ltr"
  lang="en"
  data-theme=""
  
    class="html theme--light"
  
><head>
  <title>
    Seán O&#39;Doherty
        |
        Homework 2
      

    

  </title>

  
  <meta charset="utf-8" /><meta name="generator" content="Hugo 0.113.0"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="author" content="Seán O&#39;Doherty" />
  <meta
    name="description"
    content="E628 Portfolio Website"
  />
  
  
    
    
    <link
      rel="stylesheet"
      href="/scss/main.min.1147aa5bacb4bce677a0e264073829caedb82fd18ea07a5f1d80521f539d1c45.css"
      integrity="sha256-EUeqW6y0vOZ3oOJkBzgpyu24L9GOoHpfHYBSH1OdHEU="
      crossorigin="anonymous"
      type="text/css"
    />
  

  
  <link
    rel="stylesheet"
    href="/css/markupHighlight.min.73ccfdf28df555e11009c13c20ced067af3cb021504cba43644c705930428b00.css"
    integrity="sha256-c8z98o31VeEQCcE8IM7QZ688sCFQTLpDZExwWTBCiwA="
    crossorigin="anonymous"
    type="text/css"
  />
  
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css"
    integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css"
    integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css"
    integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css"
    integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png" />

  <link rel="canonical" href="https://seanodoherty-portfolio-website.netlify.app/english/post/homework2_seanodoherty/" />

  
  
  
  
  <script
    type="text/javascript"
    src="/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js"
    integrity="sha256-&#43;RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI="
    crossorigin="anonymous"
  ></script>

  
    
    
    <script
      type="text/javascript"
      src="/js/anatole-theme-switcher.min.d6d329d93844b162e8bed1e915619625ca91687952177552b9b3e211014a2957.js"
      integrity="sha256-1tMp2ThEsWLovtHpFWGWJcqRaHlSF3VSubPiEQFKKVc="
      crossorigin="anonymous"
    ></script>
  

  


  
  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://seanodoherty-portfolio-website.netlify.app/images/site-feature-image.png"/>

<meta name="twitter:title" content="Homework 2"/>
<meta name="twitter:description" content="Obtain the data ## Rows: 144 ## Columns: 24 ## $ case &lt;chr&gt; &#34;New Mexico neighborhood shooting&#34;, &#34;… ## $ location."/>



  
  <meta property="og:title" content="Homework 2" />
<meta property="og:description" content="Obtain the data ## Rows: 144 ## Columns: 24 ## $ case &lt;chr&gt; &#34;New Mexico neighborhood shooting&#34;, &#34;… ## $ location." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://seanodoherty-portfolio-website.netlify.app/english/post/homework2_seanodoherty/" /><meta property="og:image" content="https://seanodoherty-portfolio-website.netlify.app/images/site-feature-image.png"/><meta property="article:section" content="english" />
<meta property="article:published_time" content="2023-05-21T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-05-21T00:00:00+00:00" /><meta property="og:site_name" content="Seán O&#39;Doherty - Portfolio Website" />




  
  
  
  
  <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "articleSection": "english",
        "name": "Homework 2",
        "headline": "Homework 2",
        "alternativeHeadline": "",
        "description": "
      
        Obtain the data ## Rows: 144 ## Columns: 24 ## $ case \u0026lt;chr\u0026gt; \u0026#34;New Mexico neighborhood shooting\u0026#34;, \u0026#34;… ## $ location.


      


    ",
        "inLanguage": "en",
        "isFamilyFriendly": "true",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/seanodoherty-portfolio-website.netlify.app\/english\/post\/homework2_seanodoherty\/"
        },
        "author" : {
            "@type": "Person",
            "name": "Seán O\u0027Doherty"
        },
        "creator" : {
            "@type": "Person",
            "name": "Seán O\u0027Doherty"
        },
        "accountablePerson" : {
            "@type": "Person",
            "name": "Seán O\u0027Doherty"
        },
        "copyrightHolder" : {
            "@type": "Person",
            "name": "Seán O\u0027Doherty"
        },
        "copyrightYear" : "2023",
        "dateCreated": "2023-05-21T00:00:00.00Z",
        "datePublished": "2023-05-21T00:00:00.00Z",
        "dateModified": "2023-05-21T00:00:00.00Z",
        "publisher":{
            "@type":"Organization",
            "name": "Seán O'Doherty",
            "url": "https://seanodoherty-portfolio-website.netlify.app/",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/seanodoherty-portfolio-website.netlify.app\/favicons\/favicon-32x32.png",
                "width":"32",
                "height":"32"
            }
        },
        "image": 
      [
        
        "https://seanodoherty-portfolio-website.netlify.app/images/site-feature-image.png"


      
      ]

    ,
        "url" : "https:\/\/seanodoherty-portfolio-website.netlify.app\/english\/post\/homework2_seanodoherty\/",
        "wordCount" : "4662",
        "genre" : [ ],
        "keywords" : [ ]
    }
  </script>


</head>
<body class="body">
    <div class="wrapper">
      <aside
        
          class="wrapper__sidebar"
        
      ><div
  class="sidebar
    animated fadeInDown
  "
>
  <div class="sidebar__content">
    <div class="sidebar__introduction">
      <img
        class="sidebar__introduction-profileimage"
        src="/images/Sean%20O%27Doherty.jpg"
        alt="profile picture"
      />
      
        <div class="sidebar__introduction-title">
          <a href="/">Seán O&#39;Doherty - Portfolio Website</a>
        </div>
      
      <div class="sidebar__introduction-description">
        <p>E628 Portfolio Website</p>
      </div>
    </div>
    <ul class="sidebar__list">
      
        <li class="sidebar__list-item">
          <a
            href="https://www.linkedin.com/in/sean-odoherty/"
            target="_blank"
            rel="noopener me"
            aria-label="Linkedin"
            title="Linkedin"
          >
            <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://github.com/seanodoherty"
            target="_blank"
            rel="noopener me"
            aria-label="GitHub"
            title="GitHub"
          >
            <i class="fab fa-github fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="sodoherty.mba2024@london.edu"
            target="_blank"
            rel="noopener me"
            aria-label="e-mail"
            title="e-mail"
          >
            <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
    </ul>
  </div><footer class="footer footer__sidebar">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Seán O&#39;Doherty
        2023
      
    </li>
    
      <li class="footer__item">
        <a
          class="link"
          href="/imprint/"
          
          title=""
        >
          imprint
        </a>
      </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js"
    integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ="
    crossorigin="anonymous"
  ></script></div>
</aside>
      <main
        
          class="wrapper__main"
        
      >
        <header class="header"><div
  class="
    animated fadeInDown
  "
>
  <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
  </a>
  <nav class="nav">
    <ul class="nav__list" id="navMenu">
      
      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/"
              
              title=""
              >Home</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/post/"
              
              title=""
              >Posts</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/portfolio/"
              
              title=""
              >Portfolio</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/about/"
              
              title=""
              >About</a
            >
          </li>
        

      
        
        

          <li class="nav__list-item">
            <div class="optionswitch">
              <input class="optionswitch__picker" type="checkbox" id="4" hidden />

              
              
                

              
                

              


              <label class="optionswitch__label" for="4"
                >Accomplishments <i class="fa fa-angle-down" aria-hidden="true"></i
              ></label>

              <div class="optionswitch__triangle"></div>
              <ul class="optionswitch__list">
                
                  <li class="optionswitch__list-item">
                    
                    <a
                      href="/awards/"
                      
                      title=""
                      >Awards</a
                    >
                  </li>
                
                  <li class="optionswitch__list-item">
                    
                    <a
                      href="/certifications/"
                      
                      title=""
                      >Certifications</a
                    >
                  </li>
                
              </ul>
            </div>
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/contact/"
              
              title=""
              >Contact</a
            >
          </li>
        

      
    </ul>
    <ul class="nav__list nav__list--end">
      
      
        <li class="nav__list-item">
          <div class="themeswitch">
            <a title="Switch Theme">
              <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a>
          </div>
        </li>
      
    </ul>
  </nav>
</div>
</header>
  <div
    class="post 
      animated fadeInDown
    "
  >
    
    <div class="post__content">
      <h1>Homework 2</h1>
      <h2 id="obtain-the-data">Obtain the data</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## Rows: 144
</span></span><span class="line"><span class="cl">## Columns: 24
</span></span><span class="line"><span class="cl">## $ case                             &lt;chr&gt; &#34;New Mexico neighborhood shooting&#34;, &#34;…
</span></span><span class="line"><span class="cl">## $ location...2                     &lt;chr&gt; &#34;Farmington, New Mexico&#34;, &#34;Allen, Tex…
</span></span><span class="line"><span class="cl">## $ date                             &lt;chr&gt; &#34;5/15/23&#34;, &#34;5/6/23&#34;, &#34;4/10/23&#34;, &#34;3/27…
</span></span><span class="line"><span class="cl">## $ summary                          &lt;chr&gt; &#34;Beau Wilson, 18, opened fire on the …
</span></span><span class="line"><span class="cl">## $ fatalities                       &lt;dbl&gt; 3, 8, 5, 6, 3, 7, 11, 6, 5, 3, 5, 3, …
</span></span><span class="line"><span class="cl">## $ injured                          &lt;dbl&gt; 6, 7, 8, 6, 5, 1, 10, 6, 25, 2, 2, 2,…
</span></span><span class="line"><span class="cl">## $ total_victims                    &lt;dbl&gt; 9, 15, 13, 12, 8, 8, 21, 12, 30, 5, 7…
</span></span><span class="line"><span class="cl">## $ location...8                     &lt;chr&gt; &#34;Other&#34;, &#34;Other&#34;, &#34;workplace&#34;, &#34;Schoo…
</span></span><span class="line"><span class="cl">## $ age_of_shooter                   &lt;chr&gt; &#34;18&#34;, &#34;33&#34;, &#34;25&#34;, &#34;28&#34;, &#34;43&#34;, &#34;67&#34;, &#34;…
</span></span><span class="line"><span class="cl">## $ prior_signs_mental_health_issues &lt;chr&gt; &#34;-&#34;, &#34;yes&#34;, &#34;yes&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;ye…
</span></span><span class="line"><span class="cl">## $ mental_health_details            &lt;chr&gt; &#34;-&#34;, &#34;Reportedly had a history of men…
</span></span><span class="line"><span class="cl">## $ weapons_obtained_legally         &lt;chr&gt; &#34;yes&#34;, &#34;yes&#34;, &#34;yes&#34;, &#34;yes&#34;, &#34;yes&#34;, &#34;-…
</span></span><span class="line"><span class="cl">## $ where_obtained                   &lt;chr&gt; &#34;-&#34;, &#34;-&#34;, &#34;gun dealership in Louisvil…
</span></span><span class="line"><span class="cl">## $ weapon_type                      &lt;chr&gt; &#34;semiautiomatic rifle; semiautomatic …
</span></span><span class="line"><span class="cl">## $ weapon_details                   &lt;chr&gt; &#34;AR-15-style rifle&#34;, &#34;AR-15-style rif…
</span></span><span class="line"><span class="cl">## $ race                             &lt;chr&gt; &#34;-&#34;, &#34;Latino&#34;, &#34;White&#34;, &#34;White&#34;, &#34;Bla…
</span></span><span class="line"><span class="cl">## $ gender                           &lt;chr&gt; &#34;M&#34;, &#34;M&#34;, &#34;M&#34;, &#34;F (\&#34;identifies as tr…
</span></span><span class="line"><span class="cl">## $ sources                          &lt;chr&gt; &#34;https://www.cbsnews.com/news/farming…
</span></span><span class="line"><span class="cl">## $ mental_health_sources            &lt;chr&gt; &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;https:…
</span></span><span class="line"><span class="cl">## $ sources_additional_age           &lt;chr&gt; &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-…
</span></span><span class="line"><span class="cl">## $ latitude                         &lt;chr&gt; &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-…
</span></span><span class="line"><span class="cl">## $ longitude                        &lt;chr&gt; &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-&#34;, &#34;-…
</span></span><span class="line"><span class="cl">## $ type                             &lt;chr&gt; &#34;mass&#34;, &#34;Mass&#34;, &#34;Mass&#34;, &#34;Mass&#34;, &#34;Mass…
</span></span><span class="line"><span class="cl">## $ year                             &lt;dbl&gt; 2023, 2023, 2023, 2023, 2023, 2023, 2…
</span></span></code></pre></div><h2 id="explore-the-data">Explore the data</h2>
<h3 id="specific-questions">Specific questions</h3>
<ul>
<li>Generate a data frame that summarizes the number of mass shootings per year.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">mass_shootings</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">summarise</span><span class="p">(</span><span class="n">shootings</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 39 × 2
</span></span><span class="line"><span class="cl">##     year shootings
</span></span><span class="line"><span class="cl">##    &lt;dbl&gt;     &lt;int&gt;
</span></span><span class="line"><span class="cl">##  1  1982         1
</span></span><span class="line"><span class="cl">##  2  1984         2
</span></span><span class="line"><span class="cl">##  3  1986         1
</span></span><span class="line"><span class="cl">##  4  1987         1
</span></span><span class="line"><span class="cl">##  5  1988         1
</span></span><span class="line"><span class="cl">##  6  1989         2
</span></span><span class="line"><span class="cl">##  7  1990         1
</span></span><span class="line"><span class="cl">##  8  1991         3
</span></span><span class="line"><span class="cl">##  9  1992         2
</span></span><span class="line"><span class="cl">## 10  1993         4
</span></span><span class="line"><span class="cl">## # ℹ 29 more rows
</span></span></code></pre></div><ul>
<li>Generate a bar chart that identifies the number of mass shooters associated with each race category. The bars should be sorted from highest to lowest and each bar should show its number.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">#store to table</span>
</span></span><span class="line"><span class="cl"><span class="n">race_shootings</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># create data frame using group by and summarise</span>
</span></span><span class="line"><span class="cl">  <span class="n">mass_shootings</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># use mutate to remove case sensitivity</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">race</span> <span class="o">=</span> <span class="nf">str_to_title</span><span class="p">(</span><span class="n">race</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="c1"># group by and summarise to get counts by race</span>
</span></span><span class="line"><span class="cl">    <span class="nf">group_by</span><span class="p">(</span><span class="n">race</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">summarise</span><span class="p">(</span><span class="n">shootings</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="c1"># create plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">race_shootings</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="nf">aes</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># sort race by shootings high to low on the x axis</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="nf">fct_rev</span><span class="p">(</span><span class="nf">fct_reorder</span><span class="p">(</span><span class="n">race</span><span class="p">,</span> <span class="n">shootings</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">shootings</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># add cols with blue fill and black outline</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_col</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;black&#34;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;skyblue&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># add data labels</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_text</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># set label value</span>
</span></span><span class="line"><span class="cl">    <span class="nf">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">shootings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># set label color</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;black&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># adjust vertical position of label</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">vjust</span> <span class="o">=</span> <span class="m">-0.2</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># apply theme</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add labels</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Race&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="s">&#34;Shootings&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Shootings by Race&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-4-1.png" width="672" />
<ul>
<li>Generate a boxplot visualizing the number of total victims, by type of location.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># store to table</span>
</span></span><span class="line"><span class="cl"><span class="n">location_type_total_victims</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">  <span class="n">mass_shootings</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># remove \n characters from location_type</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">location_type</span> <span class="o">=</span> <span class="nf">str_remove_all</span><span class="p">(</span><span class="n">location...8</span><span class="p">,</span> <span class="s">&#34;\n&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># make all location types title case</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">location_type</span> <span class="o">=</span> <span class="nf">str_to_title</span><span class="p">(</span><span class="n">location_type</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create boxplot from data</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">location_type_total_victims</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="nf">aes</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">location_type</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">total_victims</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_boxplot</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add theme</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add lables</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Location Type&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="s">&#34;Total Victims&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-5-1.png" width="672" />
<ul>
<li>Redraw the same plot, but remove the Las Vegas Strip massacre from the dataset.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># store to table</span>
</span></span><span class="line"><span class="cl"><span class="n">location_type_total_victims_noLV</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">  <span class="n">location_type_total_victims</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">#filter out the las vegas strip massacre</span>
</span></span><span class="line"><span class="cl">    <span class="nf">filter</span><span class="p">(</span><span class="n">case</span> <span class="o">!=</span> <span class="s">&#34;Las Vegas Strip massacre&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#create boxplot from data</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">location_type_total_victims_noLV</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="nf">aes</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">location_type</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">total_victims</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_boxplot</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add theme</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add lables</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Location Type&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="s">&#34;Total Victims&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-6-1.png" width="672" />
<h3 id="more-open-ended-questions">More open-ended questions</h3>
<p>Address the following questions. Generate appropriate figures/tables to support your conclusions.</p>
<ul>
<li>
<p>How many white males with prior signs of mental illness initiated a mass shooting after 2000?</p>
<p><em>42</em></p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">mass_shootings</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># use mutate to remove case sensitivity</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">race</span> <span class="o">=</span> <span class="nf">str_to_title</span><span class="p">(</span><span class="n">race</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">prior_signs_mental_health_issues</span> <span class="o">=</span> <span class="nf">str_to_title</span><span class="p">(</span><span class="n">prior_signs_mental_health_issues</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># Add filter conditions</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">race</span> <span class="o">==</span> <span class="s">&#34;White&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">prior_signs_mental_health_issues</span> <span class="o">==</span> <span class="s">&#34;Yes&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">year</span> <span class="o">&gt;-</span> <span class="m">2000</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># Summarise to get count</span>
</span></span><span class="line"><span class="cl">  <span class="nf">summarise</span><span class="p">(</span><span class="nf">n</span><span class="p">())</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 1 × 1
</span></span><span class="line"><span class="cl">##   `n()`
</span></span><span class="line"><span class="cl">##   &lt;int&gt;
</span></span><span class="line"><span class="cl">## 1    42
</span></span></code></pre></div><ul>
<li>Which month of the year has the most mass shootings? Generate a bar chart sorted in chronological (natural) order (Jan-Feb-Mar- etc) to provide evidence of your answer.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">#store to table</span>
</span></span><span class="line"><span class="cl"><span class="n">month_shootings</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">  <span class="n">mass_shootings</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="c1"># convert strings to date format</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">date_formatted</span> <span class="o">=</span> <span class="nf">mdy</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="c1"># extract month from date  </span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">date_month</span> <span class="o">=</span> <span class="nf">month</span><span class="p">(</span><span class="n">date_formatted</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># get month name from date</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">date_month_name</span> <span class="o">=</span> <span class="nf">month</span><span class="p">(</span><span class="n">date_formatted</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># group by month and summarise to get number of shootings</span>
</span></span><span class="line"><span class="cl">    <span class="nf">group_by</span><span class="p">(</span><span class="n">date_month</span><span class="p">,</span> <span class="n">date_month_name</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">summarise</span><span class="p">(</span><span class="n">shootings</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## `summarise()` has grouped output by &#39;date_month&#39;. You can override using the
</span></span><span class="line"><span class="cl">## `.groups` argument.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># create plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">month_shootings</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="nf">aes</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># sort race by shootings high to low on the x axis</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="nf">fct_reorder</span><span class="p">(</span><span class="n">date_month_name</span><span class="p">,</span> <span class="n">date_month</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">shootings</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># add cols with blue fill and black outline</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_col</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;black&#34;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;skyblue&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Add labels</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_text</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># set label value</span>
</span></span><span class="line"><span class="cl">    <span class="nf">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">shootings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># set label color</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;black&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># adjust vertical position of label</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">vjust</span> <span class="o">=</span> <span class="m">-0.2</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># apply theme</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add labels</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Month&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="s">&#34;Shootings&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Shootings by Month&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-8-1.png" width="672" />
<ul>
<li>How does the distribution of mass shooting fatalities differ between White and Black shooters? What about White and Latino shooters?</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># plt to compare black and white shooters</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># use mutate to remove case sensitivity</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">mass_shootings</span><span class="p">,</span> <span class="n">race</span> <span class="o">=</span> <span class="nf">str_to_title</span><span class="p">(</span><span class="n">race</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">filter</span><span class="p">(</span><span class="n">race</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;White&#34;</span><span class="p">,</span> <span class="s">&#34;Black&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">fatalities</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># create histogram+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_histogram</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add facet wrap on race</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">race</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># apply theme and labels</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Fatality Distribution (White and Black shooters)&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Fatalities&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="kc">NULL</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</span></span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-9-1.png" width="672" />
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># plt to compare white and Latino shooters</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># use mutate to remove case sensitivity</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">mass_shootings</span><span class="p">,</span> <span class="n">race</span> <span class="o">=</span> <span class="nf">str_to_title</span><span class="p">(</span><span class="n">race</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">filter</span><span class="p">(</span><span class="n">race</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;White&#34;</span><span class="p">,</span> <span class="s">&#34;Latino&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">fatalities</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># create histogram+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_histogram</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add facet wrap on race</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">race</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># apply theme and labels</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Fatality Distribution (White and Latino shooters)&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Fatalities&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="kc">NULL</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</span></span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-9-2.png" width="672" />
<h3 id="very-open-ended">Very open-ended</h3>
<ul>
<li>Are mass shootings with shooters suffering from mental illness different from mass shootings with no signs of mental illness in the shooter?</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">mass_shootings_mental_health</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">  <span class="n">mass_shootings</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">mental_health_issue</span> <span class="o">=</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">prior_signs_mental_health_issues</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;Yes&#34;</span><span class="p">,</span> <span class="s">&#34;yes&#34;</span><span class="p">),</span> <span class="s">&#34;Yes&#34;</span><span class="p">,</span> <span class="s">&#34;No / Not Clear&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">age_of_shooter</span> <span class="o">=</span> <span class="nf">strtoi</span><span class="p">(</span><span class="n">age_of_shooter</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mass_shootings_mental_health</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">split</span><span class="p">(</span><span class="n">.$mental_health_issue</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">map</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## $`No / Not Clear`
</span></span><span class="line"><span class="cl">##      case           location...2           date             summary         
</span></span><span class="line"><span class="cl">##  Length:76          Length:76          Length:76          Length:76         
</span></span><span class="line"><span class="cl">##  Class :character   Class :character   Class :character   Class :character  
</span></span><span class="line"><span class="cl">##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##    fatalities        injured       total_victims    location...8      
</span></span><span class="line"><span class="cl">##  Min.   : 3.000   Min.   :  0.00   Min.   :  3.00   Length:76         
</span></span><span class="line"><span class="cl">##  1st Qu.: 3.750   1st Qu.:  1.00   1st Qu.:  5.00   Class :character  
</span></span><span class="line"><span class="cl">##  Median : 5.000   Median :  2.00   Median :  8.00   Mode  :character  
</span></span><span class="line"><span class="cl">##  Mean   : 7.289   Mean   : 13.33   Mean   : 20.62                     
</span></span><span class="line"><span class="cl">##  3rd Qu.: 7.000   3rd Qu.:  8.00   3rd Qu.: 15.00                     
</span></span><span class="line"><span class="cl">##  Max.   :58.000   Max.   :546.00   Max.   :604.00                     
</span></span><span class="line"><span class="cl">##                                                                       
</span></span><span class="line"><span class="cl">##  age_of_shooter  prior_signs_mental_health_issues mental_health_details
</span></span><span class="line"><span class="cl">##  Min.   :11.00   Length:76                        Length:76            
</span></span><span class="line"><span class="cl">##  1st Qu.:22.00   Class :character                 Class :character     
</span></span><span class="line"><span class="cl">##  Median :31.00   Mode  :character                 Mode  :character     
</span></span><span class="line"><span class="cl">##  Mean   :33.86                                                         
</span></span><span class="line"><span class="cl">##  3rd Qu.:43.75                                                         
</span></span><span class="line"><span class="cl">##  Max.   :70.00                                                         
</span></span><span class="line"><span class="cl">##  NA&#39;s   :2                                                             
</span></span><span class="line"><span class="cl">##  weapons_obtained_legally where_obtained     weapon_type       
</span></span><span class="line"><span class="cl">##  Length:76                Length:76          Length:76         
</span></span><span class="line"><span class="cl">##  Class :character         Class :character   Class :character  
</span></span><span class="line"><span class="cl">##  Mode  :character         Mode  :character   Mode  :character  
</span></span><span class="line"><span class="cl">##                                                                
</span></span><span class="line"><span class="cl">##                                                                
</span></span><span class="line"><span class="cl">##                                                                
</span></span><span class="line"><span class="cl">##                                                                
</span></span><span class="line"><span class="cl">##  weapon_details         race              gender            sources         
</span></span><span class="line"><span class="cl">##  Length:76          Length:76          Length:76          Length:76         
</span></span><span class="line"><span class="cl">##  Class :character   Class :character   Class :character   Class :character  
</span></span><span class="line"><span class="cl">##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##  mental_health_sources sources_additional_age   latitude        
</span></span><span class="line"><span class="cl">##  Length:76             Length:76              Length:76         
</span></span><span class="line"><span class="cl">##  Class :character      Class :character       Class :character  
</span></span><span class="line"><span class="cl">##  Mode  :character      Mode  :character       Mode  :character  
</span></span><span class="line"><span class="cl">##                                                                 
</span></span><span class="line"><span class="cl">##                                                                 
</span></span><span class="line"><span class="cl">##                                                                 
</span></span><span class="line"><span class="cl">##                                                                 
</span></span><span class="line"><span class="cl">##   longitude             type                year      mental_health_issue
</span></span><span class="line"><span class="cl">##  Length:76          Length:76          Min.   :1986   Length:76          
</span></span><span class="line"><span class="cl">##  Class :character   Class :character   1st Qu.:2009   Class :character   
</span></span><span class="line"><span class="cl">##  Mode  :character   Mode  :character   Median :2017   Mode  :character   
</span></span><span class="line"><span class="cl">##                                        Mean   :2013                      
</span></span><span class="line"><span class="cl">##                                        3rd Qu.:2019                      
</span></span><span class="line"><span class="cl">##                                        Max.   :2023                      
</span></span><span class="line"><span class="cl">##                                                                          
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $Yes
</span></span><span class="line"><span class="cl">##      case           location...2           date             summary         
</span></span><span class="line"><span class="cl">##  Length:68          Length:68          Length:68          Length:68         
</span></span><span class="line"><span class="cl">##  Class :character   Class :character   Class :character   Class :character  
</span></span><span class="line"><span class="cl">##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##    fatalities        injured       total_victims   location...8      
</span></span><span class="line"><span class="cl">##  Min.   : 3.000   Min.   : 0.000   Min.   : 3.00   Length:68         
</span></span><span class="line"><span class="cl">##  1st Qu.: 5.000   1st Qu.: 1.000   1st Qu.: 7.75   Class :character  
</span></span><span class="line"><span class="cl">##  Median : 7.000   Median : 4.000   Median :11.50   Mode  :character  
</span></span><span class="line"><span class="cl">##  Mean   : 8.279   Mean   : 8.721   Mean   :17.00                     
</span></span><span class="line"><span class="cl">##  3rd Qu.: 9.000   3rd Qu.:13.000   3rd Qu.:21.25                     
</span></span><span class="line"><span class="cl">##  Max.   :32.000   Max.   :70.000   Max.   :82.00                     
</span></span><span class="line"><span class="cl">##  age_of_shooter  prior_signs_mental_health_issues mental_health_details
</span></span><span class="line"><span class="cl">##  Min.   :15.00   Length:68                        Length:68            
</span></span><span class="line"><span class="cl">##  1st Qu.:23.00   Class :character                 Class :character     
</span></span><span class="line"><span class="cl">##  Median :34.50   Mode  :character                 Mode  :character     
</span></span><span class="line"><span class="cl">##  Mean   :33.79                                                         
</span></span><span class="line"><span class="cl">##  3rd Qu.:42.00                                                         
</span></span><span class="line"><span class="cl">##  Max.   :72.00                                                         
</span></span><span class="line"><span class="cl">##  weapons_obtained_legally where_obtained     weapon_type       
</span></span><span class="line"><span class="cl">##  Length:68                Length:68          Length:68         
</span></span><span class="line"><span class="cl">##  Class :character         Class :character   Class :character  
</span></span><span class="line"><span class="cl">##  Mode  :character         Mode  :character   Mode  :character  
</span></span><span class="line"><span class="cl">##                                                                
</span></span><span class="line"><span class="cl">##                                                                
</span></span><span class="line"><span class="cl">##                                                                
</span></span><span class="line"><span class="cl">##  weapon_details         race              gender            sources         
</span></span><span class="line"><span class="cl">##  Length:68          Length:68          Length:68          Length:68         
</span></span><span class="line"><span class="cl">##  Class :character   Class :character   Class :character   Class :character  
</span></span><span class="line"><span class="cl">##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##                                                                             
</span></span><span class="line"><span class="cl">##  mental_health_sources sources_additional_age   latitude        
</span></span><span class="line"><span class="cl">##  Length:68             Length:68              Length:68         
</span></span><span class="line"><span class="cl">##  Class :character      Class :character       Class :character  
</span></span><span class="line"><span class="cl">##  Mode  :character      Mode  :character       Mode  :character  
</span></span><span class="line"><span class="cl">##                                                                 
</span></span><span class="line"><span class="cl">##                                                                 
</span></span><span class="line"><span class="cl">##                                                                 
</span></span><span class="line"><span class="cl">##   longitude             type                year      mental_health_issue
</span></span><span class="line"><span class="cl">##  Length:68          Length:68          Min.   :1982   Length:68          
</span></span><span class="line"><span class="cl">##  Class :character   Class :character   1st Qu.:1999   Class :character   
</span></span><span class="line"><span class="cl">##  Mode  :character   Mode  :character   Median :2012   Mode  :character   
</span></span><span class="line"><span class="cl">##                                        Mean   :2008                      
</span></span><span class="line"><span class="cl">##                                        3rd Qu.:2017                      
</span></span><span class="line"><span class="cl">##                                        Max.   :2023
</span></span></code></pre></div><p><em>For shooters with confirmed higher mental health issues we see higher mean fatalities but lower total victims. This indicates that these shooters are more lethal.</em></p>
<p><em>The ages of the shooters do not vary much</em></p>
<ul>
<li>Assess the relationship between mental illness and total victims, mental illness and location type, and the intersection of all three variables.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">mass_shootings_mental_health</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">mental_health_issue</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">shootings</span> <span class="o">=</span> <span class="nf">n</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">total_victims</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">total_victims</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">total_victims_per_shooting</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">total_victims</span><span class="p">)</span> <span class="o">/</span> <span class="nf">n</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 2 × 4
</span></span><span class="line"><span class="cl">##   mental_health_issue shootings total_victims total_victims_per_shooting
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;                   &lt;int&gt;         &lt;dbl&gt;                      &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1 No / Not Clear             76          1567                       20.6
</span></span><span class="line"><span class="cl">## 2 Yes                        68          1156                       17
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># store to new table</span>
</span></span><span class="line"><span class="cl"><span class="n">location_type_mental_health</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">  <span class="n">mass_shootings_mental_health</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># remove \n characters from location_type</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">location_type</span> <span class="o">=</span> <span class="nf">str_remove_all</span><span class="p">(</span><span class="n">location...8</span><span class="p">,</span> <span class="s">&#34;\n&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># make all location types title case</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">location_type</span> <span class="o">=</span> <span class="nf">str_to_title</span><span class="p">(</span><span class="n">location_type</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="c1"># group by categories</span>
</span></span><span class="line"><span class="cl">    <span class="nf">group_by</span><span class="p">(</span><span class="n">mental_health_issue</span><span class="p">,</span> <span class="n">location_type</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># summarise to get statistics</span>
</span></span><span class="line"><span class="cl">    <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">shootings</span> <span class="o">=</span> <span class="nf">n</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">total_victims</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">total_victims</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## `summarise()` has grouped output by &#39;mental_health_issue&#39;. You can override
</span></span><span class="line"><span class="cl">## using the `.groups` argument.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># create heatmap for shootings</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">location_type_mental_health</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="nf">aes</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">mental_health_issue</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">location_type</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">fill</span> <span class="o">=</span> <span class="n">shootings</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add tile chart</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_tile</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;white&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add value labels</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_text</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nf">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">total_victims</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;black&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add colors to the gradient</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_fill_gradient</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="s">&#34;white&#34;</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="s">&#34;red&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># Add labels and theme</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Confirmed Prior Mental Health Issue&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="s">&#34;Location Type&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;Shootings&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Shootings by Confirmed Prior Mental Health Issue and Location Type&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span>
</span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-11-1.png" width="672" />
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># create heatmap for total victims</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">location_type_mental_health</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="nf">aes</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">mental_health_issue</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">location_type</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">fill</span> <span class="o">=</span> <span class="n">total_victims</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add tile chart</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_tile</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;white&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add value labels</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_text</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nf">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">total_victims</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;black&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add colors to the gradient</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_fill_gradient</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="s">&#34;white&#34;</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="s">&#34;red&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># Add labels and theme</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Confirmed Prior Mental Health Issue&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="s">&#34;Location Type&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;Total Victims&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Total Victims by Confirmed Prior Mental Health Issue and Location Type&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span>
</span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-11-2.png" width="672" />
<p>Make sure to provide a couple of sentences of written interpretation of your tables/figures. Graphs and tables alone will not be sufficient to answer this question.</p>
<p><em>The number of shootings by those with confirmed prior mental health issues and those without are similar but those without confirmed prior mental health issues have a higher number of total victims per shooting.</em></p>
<p><em>The distribution of shootings by location type are similar between those with confirmed prior mental health issues and those without although there are slightly more workplace shootings by those without.</em></p>
<p><em>The distribution of Total Victims is heavily skewed by the Los Vegas shooting but otherwise follows a similar distribution as the number of shootings.</em></p>
<h1 id="exploring-credit-card-fraud">Exploring credit card fraud</h1>
<h2 id="obtain-the-data-1">Obtain the data</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## Rows: 671,028
</span></span><span class="line"><span class="cl">## Columns: 14
</span></span><span class="line"><span class="cl">## $ trans_date_trans_time &lt;dttm&gt; 2019-02-22 07:32:58, 2019-02-16 15:07:20, 2019-…
</span></span><span class="line"><span class="cl">## $ trans_year            &lt;dbl&gt; 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2020, …
</span></span><span class="line"><span class="cl">## $ category              &lt;chr&gt; &#34;entertainment&#34;, &#34;kids_pets&#34;, &#34;personal_care&#34;, &#34;…
</span></span><span class="line"><span class="cl">## $ amt                   &lt;dbl&gt; 7.79, 3.89, 8.43, 40.00, 54.04, 95.61, 64.95, 3.…
</span></span><span class="line"><span class="cl">## $ city                  &lt;chr&gt; &#34;Veedersburg&#34;, &#34;Holloway&#34;, &#34;Arnold&#34;, &#34;Apison&#34;, &#34;…
</span></span><span class="line"><span class="cl">## $ state                 &lt;chr&gt; &#34;IN&#34;, &#34;OH&#34;, &#34;MO&#34;, &#34;TN&#34;, &#34;CO&#34;, &#34;GA&#34;, &#34;MN&#34;, &#34;AL&#34;, …
</span></span><span class="line"><span class="cl">## $ lat                   &lt;dbl&gt; 40.1186, 40.0113, 38.4305, 35.0149, 39.4584, 32.…
</span></span><span class="line"><span class="cl">## $ long                  &lt;dbl&gt; -87.2602, -80.9701, -90.3870, -85.0164, -106.385…
</span></span><span class="line"><span class="cl">## $ city_pop              &lt;dbl&gt; 4049, 128, 35439, 3730, 277, 1841, 136, 190178, …
</span></span><span class="line"><span class="cl">## $ job                   &lt;chr&gt; &#34;Development worker, community&#34;, &#34;Child psychoth…
</span></span><span class="line"><span class="cl">## $ dob                   &lt;date&gt; 1959-10-19, 1946-04-03, 1985-03-31, 1991-01-28,…
</span></span><span class="line"><span class="cl">## $ merch_lat             &lt;dbl&gt; 39.41679, 39.74585, 37.73078, 34.53277, 39.95244…
</span></span><span class="line"><span class="cl">## $ merch_long            &lt;dbl&gt; -87.52619, -81.52477, -91.36875, -84.10676, -106…
</span></span><span class="line"><span class="cl">## $ is_fraud              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
</span></span></code></pre></div><ul>
<li>In this dataset, how likely are fraudulent transactions? Generate a table that summarizes the number and frequency of fraudulent transactions per year.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">card_fraud</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># group by transaction year</span>
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">trans_year</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># use the is_fraud field to get counts of (non) fraud transactions and frequency</span>
</span></span><span class="line"><span class="cl">  <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">non_fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">fraud_freq</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 2 × 4
</span></span><span class="line"><span class="cl">##   trans_year fraud_count non_fraud_count fraud_freq
</span></span><span class="line"><span class="cl">##        &lt;dbl&gt;       &lt;int&gt;           &lt;int&gt;      &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1       2019        2721          475925    0.00572
</span></span><span class="line"><span class="cl">## 2       2020        1215          191167    0.00636
</span></span></code></pre></div><ul>
<li>How much money (in US$ terms) are fraudulent transactions costing the company? Generate a table that summarizes the total amount of legitimate and fraudulent transactions per year and calculate the % of fraudulent transactions, in US$ terms.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">card_fraud</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># group by year</span>
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">trans_year</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># get fraud and non fraud amounts</span>
</span></span><span class="line"><span class="cl">  <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">fraud_amt</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">amt</span><span class="p">,</span> <span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">non_fraud_amt</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">amt</span><span class="p">,</span> <span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add the pct</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">fraud_amt_pct</span> <span class="o">=</span> <span class="n">fraud_amt</span> <span class="o">/</span> <span class="p">(</span><span class="n">fraud_amt</span> <span class="o">+</span> <span class="n">non_fraud_amt</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 2 × 4
</span></span><span class="line"><span class="cl">##   trans_year fraud_amt non_fraud_amt fraud_amt_pct
</span></span><span class="line"><span class="cl">##        &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1       2019 33608762.     34081966.         0.497
</span></span><span class="line"><span class="cl">## 2       2020 13579078.     13769030.         0.497
</span></span></code></pre></div><ul>
<li>Generate a histogram that shows the distribution of amounts charged to credit card, both for legitimate and fraudulent accounts. Also, for both types of transactions, calculate some quick summary statistics.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># generate histogram</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">card_fraud</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">amt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_histogram</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">is_fraud</span><span class="p">,</span> <span class="n">scales</span> <span class="o">=</span> <span class="s">&#34;free&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</span></span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-15-1.png" width="672" />
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="nf">filter</span><span class="p">(</span><span class="n">card_fraud</span><span class="p">,</span> <span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##  trans_date_trans_time              trans_year     category        
</span></span><span class="line"><span class="cl">##  Min.   :2019-01-02 01:06:37.00   Min.   :2019   Length:3936       
</span></span><span class="line"><span class="cl">##  1st Qu.:2019-05-04 23:31:33.00   1st Qu.:2019   Class :character  
</span></span><span class="line"><span class="cl">##  Median :2019-09-29 05:54:09.50   Median :2019   Mode  :character  
</span></span><span class="line"><span class="cl">##  Mean   :2019-09-25 17:23:00.88   Mean   :2019                     
</span></span><span class="line"><span class="cl">##  3rd Qu.:2020-02-08 00:08:40.50   3rd Qu.:2020                     
</span></span><span class="line"><span class="cl">##  Max.   :2020-06-21 03:59:46.00   Max.   :2020                     
</span></span><span class="line"><span class="cl">##       amt              city              state                lat       
</span></span><span class="line"><span class="cl">##  Min.   :   1.06   Length:3936        Length:3936        Min.   :20.03  
</span></span><span class="line"><span class="cl">##  1st Qu.: 240.49   Class :character   Class :character   1st Qu.:35.06  
</span></span><span class="line"><span class="cl">##  Median : 368.83   Mode  :character   Mode  :character   Median :39.43  
</span></span><span class="line"><span class="cl">##  Mean   : 527.21                                         Mean   :38.65  
</span></span><span class="line"><span class="cl">##  3rd Qu.: 900.95                                         3rd Qu.:41.84  
</span></span><span class="line"><span class="cl">##  Max.   :1334.07                                         Max.   :66.69  
</span></span><span class="line"><span class="cl">##       long            city_pop           job                 dob            
</span></span><span class="line"><span class="cl">##  Min.   :-165.67   Min.   :     23   Length:3936        Min.   :1925-08-29  
</span></span><span class="line"><span class="cl">##  1st Qu.: -96.70   1st Qu.:    741   Class :character   1st Qu.:1958-03-18  
</span></span><span class="line"><span class="cl">##  Median : -86.69   Median :   2526   Mode  :character   Median :1971-08-20  
</span></span><span class="line"><span class="cl">##  Mean   : -89.91   Mean   :  94096                      Mean   :1970-09-21  
</span></span><span class="line"><span class="cl">##  3rd Qu.: -79.99   3rd Qu.:  19803                      3rd Qu.:1986-11-24  
</span></span><span class="line"><span class="cl">##  Max.   : -68.56   Max.   :2906700                      Max.   :2005-01-29  
</span></span><span class="line"><span class="cl">##    merch_lat       merch_long         is_fraud
</span></span><span class="line"><span class="cl">##  Min.   :19.53   Min.   :-166.40   Min.   :1  
</span></span><span class="line"><span class="cl">##  1st Qu.:35.12   1st Qu.: -96.72   1st Qu.:1  
</span></span><span class="line"><span class="cl">##  Median :39.42   Median : -86.88   Median :1  
</span></span><span class="line"><span class="cl">##  Mean   :38.64   Mean   : -89.91   Mean   :1  
</span></span><span class="line"><span class="cl">##  3rd Qu.:41.92   3rd Qu.: -79.91   3rd Qu.:1  
</span></span><span class="line"><span class="cl">##  Max.   :67.44   Max.   : -67.57   Max.   :1
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="nf">filter</span><span class="p">(</span><span class="n">card_fraud</span><span class="p">,</span> <span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##  trans_date_trans_time             trans_year     category        
</span></span><span class="line"><span class="cl">##  Min.   :2019-01-01 00:00:51.0   Min.   :2019   Length:667092     
</span></span><span class="line"><span class="cl">##  1st Qu.:2019-06-04 06:41:49.0   1st Qu.:2019   Class :character  
</span></span><span class="line"><span class="cl">##  Median :2019-10-03 16:40:52.0   Median :2019   Mode  :character  
</span></span><span class="line"><span class="cl">##  Mean   :2019-10-03 16:30:11.0   Mean   :2019                     
</span></span><span class="line"><span class="cl">##  3rd Qu.:2020-01-28 16:17:57.5   3rd Qu.:2020                     
</span></span><span class="line"><span class="cl">##  Max.   :2020-06-21 12:12:32.0   Max.   :2020                     
</span></span><span class="line"><span class="cl">##       amt               city              state                lat       
</span></span><span class="line"><span class="cl">##  Min.   :    1.00   Length:667092      Length:667092      Min.   :20.03  
</span></span><span class="line"><span class="cl">##  1st Qu.:    9.60   Class :character   Class :character   1st Qu.:34.62  
</span></span><span class="line"><span class="cl">##  Median :   47.17   Mode  :character   Mode  :character   Median :39.35  
</span></span><span class="line"><span class="cl">##  Mean   :   67.62                                         Mean   :38.54  
</span></span><span class="line"><span class="cl">##  3rd Qu.:   82.41                                         3rd Qu.:41.89  
</span></span><span class="line"><span class="cl">##  Max.   :27119.77                                         Max.   :65.69  
</span></span><span class="line"><span class="cl">##       long            city_pop           job                 dob            
</span></span><span class="line"><span class="cl">##  Min.   :-165.67   Min.   :     23   Length:667092      Min.   :1924-10-30  
</span></span><span class="line"><span class="cl">##  1st Qu.: -96.80   1st Qu.:    741   Class :character   1st Qu.:1962-08-13  
</span></span><span class="line"><span class="cl">##  Median : -87.48   Median :   2456   Mode  :character   Median :1975-11-30  
</span></span><span class="line"><span class="cl">##  Mean   : -90.23   Mean   :  88876                      Mean   :1973-10-15  
</span></span><span class="line"><span class="cl">##  3rd Qu.: -80.16   3rd Qu.:  20328                      3rd Qu.:1987-04-23  
</span></span><span class="line"><span class="cl">##  Max.   : -67.95   Max.   :2906700                      Max.   :2005-01-29  
</span></span><span class="line"><span class="cl">##    merch_lat       merch_long         is_fraud
</span></span><span class="line"><span class="cl">##  Min.   :19.03   Min.   :-166.67   Min.   :0  
</span></span><span class="line"><span class="cl">##  1st Qu.:34.73   1st Qu.: -96.90   1st Qu.:0  
</span></span><span class="line"><span class="cl">##  Median :39.37   Median : -87.44   Median :0  
</span></span><span class="line"><span class="cl">##  Mean   :38.53   Mean   : -90.23   Mean   :0  
</span></span><span class="line"><span class="cl">##  3rd Qu.:41.95   3rd Qu.: -80.23   3rd Qu.:0  
</span></span><span class="line"><span class="cl">##  Max.   :66.68   Max.   : -66.95   Max.   :0
</span></span></code></pre></div><ul>
<li>What types of purchases are most likely to be instances of fraud? Consider category of merchants and produce a bar chart that shows % of total fraudulent transactions sorted in order.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">card_fraud</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># group by merchant category</span>
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">category</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># use the is_fraud field to get counts of (non) fraud transactions and frequency</span>
</span></span><span class="line"><span class="cl">  <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">non_fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">fraud_freq</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">category</span> <span class="o">=</span> <span class="nf">str_replace_all</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="s">&#34;_&#34;</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">category</span> <span class="o">=</span> <span class="nf">str_to_title</span><span class="p">(</span><span class="n">category</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># create plot frame</span>
</span></span><span class="line"><span class="cl">  <span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nf">aes</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">=</span> <span class="nf">fct_rev</span><span class="p">(</span><span class="nf">fct_reorder</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">fraud_freq</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="nf">percent</span><span class="p">(</span><span class="n">fraud_freq</span><span class="p">,</span> <span class="m">0.01</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># add bar chart</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_col</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;black&#34;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;skyblue&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Add labels</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_text</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># set label value</span>
</span></span><span class="line"><span class="cl">    <span class="nf">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="nf">percent</span><span class="p">(</span><span class="n">fraud_freq</span><span class="p">,</span> <span class="m">0.01</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># set label color</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;black&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># adjust vertical position of label</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">vjust</span> <span class="o">=</span> <span class="m">-0.2</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># apply theme</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">60</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add labels</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Merchant Category&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="s">&#34;Pct of fraudulent Transactions&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Rate of Fraudelent transactions by Merchant Category&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-16-1.png" width="672" />
<ul>
<li>When is fraud more prevalent? Which days, months, hours? To create new variables to help you in your analysis, we use the <code>lubridate</code> package and the following code</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mutate(
</span></span><span class="line"><span class="cl">  date_only = lubridate::date(trans_date_trans_time),
</span></span><span class="line"><span class="cl">  month_name = lubridate::month(trans_date_trans_time, label=TRUE),
</span></span><span class="line"><span class="cl">  hour = lubridate::hour(trans_date_trans_time),
</span></span><span class="line"><span class="cl">  weekday = lubridate::wday(trans_date_trans_time, label = TRUE)
</span></span><span class="line"><span class="cl">  )
</span></span></code></pre></div><ul>
<li>Are older customers significantly more likely to be victims of credit card fraud? To calculate a customer&rsquo;s age, we use the <code>lubridate</code> package and the following code</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  mutate(
</span></span><span class="line"><span class="cl">   age = interval(dob, trans_date_trans_time) / years(1),
</span></span><span class="line"><span class="cl">    )
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">card_fraud_dates</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">  <span class="n">card_fraud</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">date_only</span> <span class="o">=</span> <span class="n">lubridate</span><span class="o">::</span><span class="nf">date</span><span class="p">(</span><span class="n">trans_date_trans_time</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">month_name</span> <span class="o">=</span> <span class="n">lubridate</span><span class="o">::</span><span class="nf">month</span><span class="p">(</span><span class="n">trans_date_trans_time</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">hour</span> <span class="o">=</span> <span class="n">lubridate</span><span class="o">::</span><span class="nf">hour</span><span class="p">(</span><span class="n">trans_date_trans_time</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">lubridate</span><span class="o">::</span><span class="nf">wday</span><span class="p">(</span><span class="n">trans_date_trans_time</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">age</span> <span class="o">=</span> <span class="nf">interval</span><span class="p">(</span><span class="n">dob</span><span class="p">,</span> <span class="n">trans_date_trans_time</span><span class="p">)</span> <span class="o">/</span> <span class="nf">years</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">card_fraud_dates</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">weekday</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">non_fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">fraud_freq</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">fraud_freq</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 7 × 4
</span></span><span class="line"><span class="cl">##   weekday fraud_count non_fraud_count fraud_freq
</span></span><span class="line"><span class="cl">##   &lt;ord&gt;         &lt;int&gt;           &lt;int&gt;      &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1 Thu             542           75658    0.00716
</span></span><span class="line"><span class="cl">## 2 Fri             557           78394    0.00711
</span></span><span class="line"><span class="cl">## 3 Wed             468           67471    0.00694
</span></span><span class="line"><span class="cl">## 4 Sat             626          103413    0.00605
</span></span><span class="line"><span class="cl">## 5 Tue             496           82434    0.00602
</span></span><span class="line"><span class="cl">## 6 Mon             639          130780    0.00489
</span></span><span class="line"><span class="cl">## 7 Sun             608          128942    0.00472
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">card_fraud_dates</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">month_name</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">non_fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">fraud_freq</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">fraud_freq</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 12 × 4
</span></span><span class="line"><span class="cl">##    month_name fraud_count non_fraud_count fraud_freq
</span></span><span class="line"><span class="cl">##    &lt;ord&gt;            &lt;int&gt;           &lt;int&gt;      &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1 Jan                461           53345    0.00864
</span></span><span class="line"><span class="cl">##  2 Feb                434           50226    0.00864
</span></span><span class="line"><span class="cl">##  3 Mar                472           74006    0.00638
</span></span><span class="line"><span class="cl">##  4 May                472           75329    0.00627
</span></span><span class="line"><span class="cl">##  5 Nov                226           36107    0.00626
</span></span><span class="line"><span class="cl">##  6 Oct                218           35869    0.00608
</span></span><span class="line"><span class="cl">##  7 Sep                219           36314    0.00603
</span></span><span class="line"><span class="cl">##  8 Jun                387           73827    0.00524
</span></span><span class="line"><span class="cl">##  9 Apr                349           69527    0.00502
</span></span><span class="line"><span class="cl">## 10 Aug                213           45067    0.00473
</span></span><span class="line"><span class="cl">## 11 Dec                301           72685    0.00414
</span></span><span class="line"><span class="cl">## 12 Jul                184           44790    0.00411
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">card_fraud_dates</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">hour</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">non_fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">fraud_freq</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">fraud_freq</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 24 × 4
</span></span><span class="line"><span class="cl">##     hour fraud_count non_fraud_count fraud_freq
</span></span><span class="line"><span class="cl">##    &lt;int&gt;       &lt;int&gt;           &lt;int&gt;      &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1    23        1012           33613    0.0301 
</span></span><span class="line"><span class="cl">##  2    22         981           33693    0.0291 
</span></span><span class="line"><span class="cl">##  3     0         348           21722    0.0160 
</span></span><span class="line"><span class="cl">##  4     1         332           21775    0.0152 
</span></span><span class="line"><span class="cl">##  5     3         326           21866    0.0149 
</span></span><span class="line"><span class="cl">##  6     2         313           21909    0.0143 
</span></span><span class="line"><span class="cl">##  7     7          35           21820    0.00160
</span></span><span class="line"><span class="cl">##  8    19          52           33935    0.00153
</span></span><span class="line"><span class="cl">##  9     5          32           21720    0.00147
</span></span><span class="line"><span class="cl">## 10    18          49           34082    0.00144
</span></span><span class="line"><span class="cl">## # ℹ 14 more rows
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">card_fraud_dates</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">non_fraud_count</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">fraud_freq</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">fraud_freq</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 83 × 4
</span></span><span class="line"><span class="cl">##    `round(age, 0)` fraud_count non_fraud_count fraud_freq
</span></span><span class="line"><span class="cl">##              &lt;dbl&gt;       &lt;int&gt;           &lt;int&gt;      &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1              87          28            1599     0.0175
</span></span><span class="line"><span class="cl">##  2              92          38            2399     0.0158
</span></span><span class="line"><span class="cl">##  3              18          33            2103     0.0157
</span></span><span class="line"><span class="cl">##  4              77          35            2354     0.0149
</span></span><span class="line"><span class="cl">##  5              79          54            3936     0.0137
</span></span><span class="line"><span class="cl">##  6              86          22            1719     0.0128
</span></span><span class="line"><span class="cl">##  7              81          26            2034     0.0128
</span></span><span class="line"><span class="cl">##  8              94          10             819     0.0122
</span></span><span class="line"><span class="cl">##  9              71          57            4716     0.0121
</span></span><span class="line"><span class="cl">## 10              76          23            1922     0.0120
</span></span><span class="line"><span class="cl">## # ℹ 73 more rows
</span></span></code></pre></div><ul>
<li>Is fraud related to distance? The distance between a card holder&rsquo;s home and the location of the transaction can be a feature that is related to fraud. To calculate distance, we need the latidue/longitude of card holders&rsquo;s home and the latitude/longitude of the transaction, and we will use the <a href="https://en.wikipedia.org/wiki/Haversine_formula">Haversine formula</a> to calculate distance. I adapted code to <a href="https://www.geeksforgeeks.org/program-distance-two-points-earth/amp/">calculate distance between two points on earth</a> which you can find below</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># distance between card holder&#39;s home and transaction</span>
</span></span><span class="line"><span class="cl"><span class="c1"># code adapted from https://www.geeksforgeeks.org/program-distance-two-points-earth/amp/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">card_fraud</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># convert latitude/longitude to radians</span>
</span></span><span class="line"><span class="cl">    <span class="n">lat1_radians</span> <span class="o">=</span> <span class="n">lat</span> <span class="o">/</span> <span class="m">57.29577951</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">lat2_radians</span> <span class="o">=</span> <span class="n">merch_lat</span> <span class="o">/</span> <span class="m">57.29577951</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">long1_radians</span> <span class="o">=</span> <span class="n">long</span> <span class="o">/</span> <span class="m">57.29577951</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">long2_radians</span> <span class="o">=</span> <span class="n">merch_long</span> <span class="o">/</span> <span class="m">57.29577951</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># calculate distance in miles</span>
</span></span><span class="line"><span class="cl">    <span class="n">distance_miles</span> <span class="o">=</span> <span class="m">3963.0</span> <span class="o">*</span> <span class="nf">acos</span><span class="p">((</span><span class="nf">sin</span><span class="p">(</span><span class="n">lat1_radians</span><span class="p">)</span> <span class="o">*</span> <span class="nf">sin</span><span class="p">(</span><span class="n">lat2_radians</span><span class="p">))</span> <span class="o">+</span> <span class="nf">cos</span><span class="p">(</span><span class="n">lat1_radians</span><span class="p">)</span> <span class="o">*</span> <span class="nf">cos</span><span class="p">(</span><span class="n">lat2_radians</span><span class="p">)</span> <span class="o">*</span> <span class="nf">cos</span><span class="p">(</span><span class="n">long2_radians</span> <span class="o">-</span> <span class="n">long1_radians</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># calculate distance in km</span>
</span></span><span class="line"><span class="cl">    <span class="n">distance_km</span> <span class="o">=</span> <span class="m">6377.830272</span> <span class="o">*</span> <span class="nf">acos</span><span class="p">((</span><span class="nf">sin</span><span class="p">(</span><span class="n">lat1_radians</span><span class="p">)</span> <span class="o">*</span> <span class="nf">sin</span><span class="p">(</span><span class="n">lat2_radians</span><span class="p">))</span> <span class="o">+</span> <span class="nf">cos</span><span class="p">(</span><span class="n">lat1_radians</span><span class="p">)</span> <span class="o">*</span> <span class="nf">cos</span><span class="p">(</span><span class="n">lat2_radians</span><span class="p">)</span> <span class="o">*</span> <span class="nf">cos</span><span class="p">(</span><span class="n">long2_radians</span> <span class="o">-</span> <span class="n">long1_radians</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add plot</span>
</span></span><span class="line"><span class="cl">  <span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nf">aes</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">y</span> <span class="o">=</span> <span class="n">distance_km</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_boxplot</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># use facet wrap to separate by is_fraud</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">is_fraud</span><span class="p">)</span>
</span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-18-1.png" width="672" />
<p>Plot a boxplot or a violin plot that looks at the relationship of distance and <code>is_fraud</code>. Does distance seem to be a useful feature in explaining fraud?</p>
<p><em>The boxplots are extremely similar.</em></p>
<h1 id="exploring-sources-of-electricity-production-co2-emissions-and-gdp-per-capita">Exploring sources of electricity production, CO2 emissions, and GDP per capita.</h1>
<h2 id="1-a-stacked-area-chart-that-shows-how-your-own-country-generated-its-electricity-since-2000">1. A stacked area chart that shows how your own country generated its electricity since 2000.</h2>
<h2 id="2-a-scatter-plot-that-looks-at-how-co2-per-capita-and-gdp-per-capita-are-related">2. A scatter plot that looks at how CO2 per capita and GDP per capita are related</h2>
<h2 id="3-a-scatter-plot-that-looks-at-how-electricity-usage-kwh-per-capitaday-gdp-per-capita-are-related">3. A scatter plot that looks at how electricity usage (kWh) per capita/day GDP per capita are related.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Download electricity data</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">&lt;-</span> <span class="s">&#34;https://nyc3.digitaloceanspaces.com/owid-public/data/energy/owid-energy-data.csv&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">energy</span> <span class="o">&lt;-</span> <span class="nf">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="m">1990</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">drop_na</span><span class="p">(</span><span class="n">iso_code</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">select</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">biofuel</span> <span class="o">=</span> <span class="n">biofuel_electricity</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">coal</span> <span class="o">=</span> <span class="n">coal_electricity</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">gas</span> <span class="o">=</span> <span class="n">gas_electricity</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">hydro</span> <span class="o">=</span> <span class="n">hydro_electricity</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">nuclear</span> <span class="o">=</span> <span class="n">nuclear_electricity</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">oil</span> <span class="o">=</span> <span class="n">oil_electricity</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">other_renewable</span> <span class="o">=</span> <span class="n">other_renewable_exc_biofuel_electricity</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">solar</span> <span class="o">=</span> <span class="n">solar_electricity</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">wind</span> <span class="o">=</span> <span class="n">wind_electricity</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">         <span class="n">electricity_demand</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">electricity_generation</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">net_elec_imports</span><span class="p">,</span>	<span class="c1"># Net electricity imports, measured in terawatt-hours</span>
</span></span><span class="line"><span class="cl">         <span class="n">energy_per_capita</span><span class="p">,</span>	<span class="c1"># Primary energy consumption per capita, measured in kilowatt-hours	Calculated by Our World in Data based on BP Statistical Review of World Energy and EIA International Energy Data</span>
</span></span><span class="line"><span class="cl">         <span class="n">energy_per_gdp</span><span class="p">,</span>	<span class="c1"># Energy consumption per unit of GDP. This is measured in kilowatt-hours per 2011 international-$.</span>
</span></span><span class="line"><span class="cl">         <span class="n">per_capita_electricity</span><span class="p">,</span> <span class="c1">#	Electricity generation per capita, measured in kilowatt-hours</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Download data for C02 emissions per capita https://data.worldbank.org/indicator/EN.ATM.CO2E.PC</span>
</span></span><span class="line"><span class="cl"><span class="n">co2_percap</span> <span class="o">&lt;-</span> <span class="nf">wb_data</span><span class="p">(</span><span class="n">country</span> <span class="o">=</span> <span class="s">&#34;countries_only&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                      <span class="n">indicator</span> <span class="o">=</span> <span class="s">&#34;EN.ATM.CO2E.PC&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                      <span class="n">start_date</span> <span class="o">=</span> <span class="m">1990</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                      <span class="n">end_date</span> <span class="o">=</span> <span class="m">2022</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">return_wide</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="c1">#drop unwanted variables</span>
</span></span><span class="line"><span class="cl">  <span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">obs_status</span><span class="p">,</span> <span class="n">footnote</span><span class="p">,</span> <span class="n">last_updated</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">rename</span><span class="p">(</span><span class="n">year</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">co2percap</span> <span class="o">=</span> <span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Download data for GDP per capita  https://data.worldbank.org/indicator/NY.GDP.PCAP.PP.KD</span>
</span></span><span class="line"><span class="cl"><span class="n">gdp_percap</span> <span class="o">&lt;-</span> <span class="nf">wb_data</span><span class="p">(</span><span class="n">country</span> <span class="o">=</span> <span class="s">&#34;countries_only&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                      <span class="n">indicator</span> <span class="o">=</span> <span class="s">&#34;NY.GDP.PCAP.PP.KD&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                      <span class="n">start_date</span> <span class="o">=</span> <span class="m">1990</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                      <span class="n">end_date</span> <span class="o">=</span> <span class="m">2022</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">return_wide</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="c1">#drop unwanted variables</span>
</span></span><span class="line"><span class="cl">  <span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">obs_status</span><span class="p">,</span> <span class="n">footnote</span><span class="p">,</span> <span class="n">last_updated</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">rename</span><span class="p">(</span><span class="n">year</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">GDPpercap</span> <span class="o">=</span> <span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># save to p1</span>
</span></span><span class="line"><span class="cl"><span class="n">p1</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl"><span class="n">energy</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># select only cols needed</span>
</span></span><span class="line"><span class="cl">  <span class="nf">select</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># filter to relevant data</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">country</span> <span class="o">==</span> <span class="s">&#34;Ireland&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="m">2000</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># pivot to long format</span>
</span></span><span class="line"><span class="cl">  <span class="nf">pivot_longer</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">cols</span> <span class="o">=</span> <span class="m">4</span><span class="o">:</span><span class="m">12</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">names_to</span> <span class="o">=</span> <span class="s">&#34;energy_source&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">values_to</span> <span class="o">=</span> <span class="s">&#34;energy_usage&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># create plot</span>
</span></span><span class="line"><span class="cl">  <span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nf">aes</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">=</span> <span class="n">year</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">energy_usage</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">fill</span> <span class="o">=</span> <span class="n">energy_source</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add area chart</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_area</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s">&#34;grey90&#34;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s">&#34;fill&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># add theme labels</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Year&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="s">&#34;Energy Usage&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;Energy Source&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Area Chart for Energy Usage in Ireland since 2000&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># save to p2</span>
</span></span><span class="line"><span class="cl"><span class="n">p2</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># join tables on country and year</span>
</span></span><span class="line"><span class="cl"><span class="nf">inner_join</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">=</span> <span class="n">co2_percap</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">gdp_percap</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="n">by</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;iso3c&#34;</span><span class="p">,</span> <span class="s">&#34;year&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="n">keep</span> <span class="o">=</span> <span class="kc">TRUE</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># set up plot</span>
</span></span><span class="line"><span class="cl">  <span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nf">aes</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">=</span> <span class="n">co2percap</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">GDPpercap</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add scatter</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add line of best fit</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_smooth</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add theme</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># save to p3</span>
</span></span><span class="line"><span class="cl"><span class="n">p3</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># left join eregy to gdp</span>
</span></span><span class="line"><span class="cl"><span class="nf">left_join</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">=</span> <span class="nf">select</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;iso_code&#34;</span><span class="p">,</span> <span class="s">&#34;year&#34;</span><span class="p">,</span> <span class="s">&#34;per_capita_electricity&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="nf">select</span><span class="p">(</span><span class="n">gdp_percap</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;iso3c&#34;</span><span class="p">,</span> <span class="s">&#34;year&#34;</span><span class="p">,</span> <span class="s">&#34;GDPpercap&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span><span class="n">by</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;iso_code&#34;</span> <span class="o">=</span> <span class="s">&#34;iso3c&#34;</span><span class="p">,</span> <span class="s">&#34;year&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nf">aes</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">=</span> <span class="n">per_capita_electricity</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">GDPpercap</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add scatter</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add line of best fit</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_smooth</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># add theme</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_light</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># use patchwork to display the charts</span>
</span></span><span class="line"><span class="cl"><span class="n">p1</span> <span class="o">/</span> <span class="p">(</span><span class="n">p2</span> <span class="o">+</span> <span class="n">p3</span><span class="p">)</span>
</span></span></code></pre></div><img src="/english/post/homework2_seanodoherty_files/figure-html/unnamed-chunk-19-1.png" width="672" />
<p>Specific questions:</p>
<ol>
<li>
<p>How would you turn <code>energy</code> to long, tidy format?</p>
<p><em>See pivot in code block above</em></p>
</li>
<li>
<p>You may need to join these data frames</p>
<ul>
<li>Use <code>left_join</code> from <code>dplyr</code> to <a href="http://r4ds.had.co.nz/relational-data.html">join the tables</a></li>
<li>To complete the merge, you need a unique <em>key</em> to match observations between the data frames. Country names may not be consistent among the three dataframes, so please use the 3-digit ISO code for each country</li>
<li>An aside: There is a great package called <a href="https://github.com/vincentarelbundock/countrycode"><code>countrycode</code></a> that helps solve the problem of inconsistent country names (Is it UK? United Kingdon? Great Britain?). <code>countrycode()</code> takes as an input a country&rsquo;s name in a specific format and outputs it using whatever format you specify.</li>
</ul>
</li>
<li>
<p>Write a function that takes as input any country&rsquo;s name and returns all three graphs. You can use the <code>patchwork</code> package to arrange the three graphs as shown below</p>
<p><em>I cannot get the image to load!!</em></p>
</li>
</ol>
<p><img src="images/electricity-co2-gdp.png" alt=""></p>
<h1 id="deliverables">Deliverables</h1>
<p>There is a lot of explanatory text, comments, etc. You do not need these, so delete them and produce a stand-alone document that you could share with someone. Knit the edited and completed Quarto Markdown (qmd) file as a Word document (use the &ldquo;Render&rdquo; button at the top of the script editor window) and upload it to Canvas. You must be commiting and pushing tour changes to your own Github repo as you go along.</p>
<h1 id="details">Details</h1>
<ul>
<li>Who did you collaborate with: <em>n/a</em></li>
<li>Approximately how much time did you spend on this problem set: <em>4 hours</em></li>
<li>What, if anything, gave you the most trouble: <em>The number of questions!</em></li>
</ul>
</div>
    <div class="post__footer">
      

      
    </div>

    
  </div>

      </main>
    </div><footer class="footer footer__base">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Seán O&#39;Doherty
        2023
      
    </li>
    
      <li class="footer__item">
        <a
          class="link"
          href="/imprint/"
          
          title=""
        >
          imprint
        </a>
      </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js"
    integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ="
    crossorigin="anonymous"
  ></script></body>
</html>
